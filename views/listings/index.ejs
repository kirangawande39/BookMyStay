<!-- <% layout('/layouts/boilerplate') -%>
<style>
  .filters {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
    margin-top: 10px;
    margin-bottom: 10px;
  }

  i {
    font-size: 1rem;
  }

  .filter {
    text-align: center;
    font-size: 0.75rem;
    cursor: pointer;
    opacity: 0.75;
  }

  .filter:hover {
    opacity: 1;
  }

  .tax-switch {
    padding: 10px;
    border-radius: 20px;
    border: 2px solid black;
  }
</style>

<body>
  <div class="container mt-4">
    <div class="filters">
      <div class="filter">
        <i class="fa-solid fa-binoculars"></i>
        <h5>Amazing views</h5>
      </div>
      <div class="filter">
        <i class="fa-solid fa-tractor"></i>
        <h5>Farms</h5>
      </div>
      <div class="filter">
        <i class="fa-solid fa-tree"></i>
        <h5>Treehouses</h5>
      </div>
      <div class="filter">
        <i class="fa-solid fa-city"></i>
        <h5>Top cities</h5>
      </div>
      <div class="filter">
        <i class="fa-regular fa-hourglass-half"></i>
        <h5>Trending</h5>
      </div>
      <div class="filter">
        <i class="fa-solid fa-sailboat"></i>
        <h5>Boats</h5>
      </div>
      <div class="tax-switch">
        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" role="switch" id="taxSwitch">
          <label class="form-check-label" for="taxSwitch">Include 18% taxes</label>
        </div>
      </div>
    </div>

    <div class="row row-cols-1 row-cols-md-3 g-4">
      <% for(data of alldata) { %>
      <div class="col">
        <a href="/listings/<%= data._id %>" class="text-decoration-none">
          <div class="card h-100 shadow">
            <img src="<%= data.image.url %>" class="card-img-top" alt="listing-image" style="height: 200px; width: 100%; object-fit: cover;">
            <div class="card-img-overlay">
              <h5><span class="badge text-bg-secondary"><%= data.country %></span></h5>
            </div>
            <div class="card-body">
              <h5 class="card-title text-dark"><%= data.title %></h5>
              <p class="card-text text-muted">
                Price: <span class="text-dark price" data-original="<%= data.price %>">&#8377; <%= data.price %></span> /night
              </p>
            </div>
          </div>
        </a>
      </div>
      <% } %>
    </div>
  </div>

  <script>
    // Define tax rate (18%)
    const TAX_RATE = 0.18;

    // Get all price elements and the switch
    const priceElements = document.querySelectorAll('.price');
    const taxSwitch = document.getElementById('taxSwitch');

    // Update prices based on tax toggle
    taxSwitch.addEventListener('change', () => {
      priceElements.forEach(priceElement => {
        const originalPrice = parseFloat(priceElement.dataset.original);
        if (taxSwitch.checked) {
          const taxedPrice = originalPrice + originalPrice * TAX_RATE;
          priceElement.textContent = `₹ ${taxedPrice.toFixed(2)}`;
        } else {
          priceElement.textContent = `₹ ${originalPrice.toFixed(2)}`;
        }
      });
    });

    // Set default state (if necessary)
    window.onload = () => {
      if (taxSwitch.checked) {
        priceElements.forEach(priceElement => {
          const originalPrice = parseFloat(priceElement.dataset.original);
          const taxedPrice = originalPrice + originalPrice * TAX_RATE;
          priceElement.textContent = `₹ ${taxedPrice.toFixed(2)}`;
        });
      }
    };
  </script>
</body>

</html> -->



<% layout('/layouts/boilerplate') -%>
<style>
  .filters {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
    margin-top: 10px;
    margin-bottom: 10px;
  }

  i {
    font-size: 1rem;
  }

  .filter {
    text-align: center;
    font-size: 0.75rem;
    cursor: pointer;
    opacity: 0.75;
  }

  .filter:hover {
    opacity: 1;
  }

  .tax-switch {
    padding: 10px;
    border-radius: 20px;
    border: 2px solid black;
  }
</style>

<body>
  <div class="container mt-4">
    <!-- Search Bar -->
   

    <div class="filters">
      <!-- Filters -->
      <div class="filter">
        <i class="fa-solid fa-binoculars"></i>
        <h5>Amazing views</h5>
      </div>
      <div class="filter">
        <i class="fa-solid fa-tractor"></i>
        <h5>Farms</h5>
      </div>
      <div class="filter">
        <i class="fa-solid fa-tree"></i>
        <h5>Treehouses</h5>
      </div>
      <div class="filter">
        <i class="fa-solid fa-city"></i>
        <h5>Top cities</h5>
      </div>
      <div class="filter">
        <i class="fa-regular fa-hourglass-half"></i>
        <h5>Trending</h5>
      </div>
      <div class="filter">
        <i class="fa-solid fa-sailboat"></i>
        <h5>Boats</h5>
      </div>
      <div class="tax-switch">
        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" role="switch" id="taxSwitch">
          <label class="form-check-label" for="taxSwitch">Include 18% taxes</label>
        </div>
      </div>
    </div>

    <div class="row row-cols-1 row-cols-md-3 g-4">
      <% for(data of alldata) { %>
      <div class="col">
        <a href="/listings/<%= data._id %>" class="text-decoration-none">
          <div class="card h-100 shadow">
            <img src="<%= data.image.url %>" class="card-img-top" alt="listing-image" style="height: 200px; width: 100%; object-fit: cover;">
            <div class="card-img-overlay">
              <h5><span class="badge text-bg-secondary"><%= data.country %></span></h5>
            </div>
            <div class="card-body">
              <h5 class="card-title text-dark"><%= data.title %></h5>
              <p class="card-text text-muted">
                Price: <span class="text-dark price" data-original="<%= data.price %>">&#8377; <%= data.price %></span> /night
              </p>
            </div>
          </div>
        </a>
      </div>
      <% } %>
    </div>
  </div>

  <script>
    // Search bar functionality
    const searchBar = document.getElementById('searchBar');
    const listings = document.querySelectorAll('.col'); // Select all listing cards

    // Event listener for the search bar
    searchBar.addEventListener('input', (e) => {
      const query = e.target.value.toLowerCase(); // Get the search query
      listings.forEach((listing) => {
        const title = listing.querySelector('.card-title').textContent.toLowerCase(); // Get the title
        const location = listing.querySelector('.badge').textContent.toLowerCase(); // Get the location (country)

        // Check if the query matches the title or location
        if (title.includes(query) || location.includes(query)) {
          listing.style.display = ''; // Show matching listing
        } else {
          listing.style.display = 'none'; // Hide non-matching listing
        }
      });
    });




    // Define tax rate (18%)
    const TAX_RATE = 0.18;

    // Get all price elements and the switch
    const priceElements = document.querySelectorAll('.price');
    const taxSwitch = document.getElementById('taxSwitch');

    // Update prices based on tax toggle
    taxSwitch.addEventListener('change', () => {
      priceElements.forEach(priceElement => {
        const originalPrice = parseFloat(priceElement.dataset.original);
        if (taxSwitch.checked) {
          const taxedPrice = originalPrice + originalPrice * TAX_RATE;
          priceElement.textContent = `₹ ${taxedPrice.toFixed(2)}`;
        } else {
          priceElement.textContent = `₹ ${originalPrice.toFixed(2)}`;
        }
      });
    });

    // Set default state (if necessary)
    window.onload = () => {
      if (taxSwitch.checked) {
        priceElements.forEach(priceElement => {
          const originalPrice = parseFloat(priceElement.dataset.original);
          const taxedPrice = originalPrice + originalPrice * TAX_RATE;
          priceElement.textContent = `₹ ${taxedPrice.toFixed(2)}`;
        });
      }
    };
  </script>
</body>

</html>
